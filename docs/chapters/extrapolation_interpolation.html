<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Scientific Computing - 15&nbsp; Extrapolation and Interpolation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/fitting.html" rel="next">
<link href="../chapters/sympy.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Extrapolation and Interpolation</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Scientific Computing</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Basic Python</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Python and Jupyter Notebooks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables and Numbers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/strings.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Strings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/booleans.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Boolean Variables and Conditionals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/listsAndTuples.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lists and Tuples</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/dictionarySet.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Dictionaries and Sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/loops.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Loops</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Intermediate Python</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/numpy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The <code>numpy</code> module</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/io.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">File I/O (Input/Output)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/basicPlotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Basic Plotting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/advancedPlotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Advanced Plotting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/pandas.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/sympy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">The <code>sympy</code> module</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Numerical Methods</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/extrapolation_interpolation.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Extrapolation and Interpolation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/fitting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Curve Fitting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/numericalCalculus.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Numerical Calculus</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#linear-interpolation-and-extrapolation" id="toc-linear-interpolation-and-extrapolation" class="nav-link active" data-scroll-target="#linear-interpolation-and-extrapolation"> <span class="header-section-number">15.1</span> Linear Interpolation and Extrapolation</a>
  <ul class="collapse">
  <li><a href="#linear-interpolation" id="toc-linear-interpolation" class="nav-link" data-scroll-target="#linear-interpolation"> <span class="header-section-number">15.1.1</span> Linear Interpolation</a></li>
  <li><a href="#linear-extrapolation" id="toc-linear-extrapolation" class="nav-link" data-scroll-target="#linear-extrapolation"> <span class="header-section-number">15.1.2</span> Linear Extrapolation</a></li>
  <li><a href="#zero-finding" id="toc-zero-finding" class="nav-link" data-scroll-target="#zero-finding"> <span class="header-section-number">15.1.3</span> Zero Finding</a></li>
  </ul></li>
  <li><a href="#quadratic-interpolation-and-extrapolation" id="toc-quadratic-interpolation-and-extrapolation" class="nav-link" data-scroll-target="#quadratic-interpolation-and-extrapolation"> <span class="header-section-number">15.2</span> Quadratic Interpolation and Extrapolation</a></li>
  <li><a href="#an-example" id="toc-an-example" class="nav-link" data-scroll-target="#an-example"> <span class="header-section-number">15.3</span> An Example</a></li>
  <li><a href="#flashcards" id="toc-flashcards" class="nav-link" data-scroll-target="#flashcards"> <span class="header-section-number">15.4</span> Flashcards</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"> <span class="header-section-number">15.5</span> Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Extrapolation and Interpolation</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p><a href="https://lancejnelson.github.io/PH135/jupyter/extrapolation_interpolation.ipynb">Jupyter Notebook</a></p>
<p>By now we should be comfortable with representing mathematical functions on discrete grids. For example, the plot below is the location of a projectile as it flies through the air at 11 discrete points in time (red dots). There will be times when we want to find good values of a function <em>between</em> grid points (blue dot) or <em>beyond</em> the last grid point (green dot). The former is called interpolation and the latter is called extrapolation. In this chapter we will learn how to do both.</p>
<div class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="extrapolation_interpolation_files/figure-html/cell-2-output-1.png" width="579" height="404" class="figure-img"></p>
<p></p><figcaption class="figure-caption">The trajectory of a particle at a discrete set of times.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="linear-interpolation-and-extrapolation" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="linear-interpolation-and-extrapolation"><span class="header-section-number">15.1</span> Linear Interpolation and Extrapolation</h2>
<p>The simplest way to estimate function values is to assume that the function is linear in the neighborhood of the data points. Using the fact that two points define a straight line will allow us to write a linear approximation to the function. For example, suppose that we have function values <span class="math inline">\((x_1,y_1)\)</span> and <span class="math inline">\((x_2,y_2)\)</span>, as shown in the figure below.</p>
<div class="cell quarto-layout-panel" data-execution_count="3">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="extrapolation_interpolation_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img" width="466"></p>
<p></p><figcaption class="figure-caption">Illustration of linear interpolation/extrapolation. The red dots are the known function values. The lack dot is an interpolation and the green dot is an extrapolation.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>The formula for a straight line that passes through these two points is</p>
<p><span class="math display">\[
y-y_1 = { (y_2-y_1) \over (x_2-x_1) } (x-x_1)
\]</span></p>
<p>Solving this for <span class="math inline">\(y\)</span> gives</p>
<p><span id="eq-linear"><span class="math display">\[
y(x) = y_1 + { (y_2-y_1) \over (x_2-x_1) } (x-x_1)
\tag{15.1}\]</span></span></p>
<p>This function provides a good approximation to the true function <span class="math inline">\(y(x)\)</span> in the neighborhood of the two data points. All we have to do is evaluate it for any <span class="math inline">\(x\)</span> we please. If we evaluate it in between two data points we call it interpolation and if we evaluate it somewhere beyond the last data point we call it extrapolation.</p>
<section id="linear-interpolation" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="linear-interpolation"><span class="header-section-number">15.1.1</span> Linear Interpolation</h3>
<p>To linearly interpolate or extrapolate we simply evaluate the equation above at <span class="math inline">\(x\)</span> values between or beyond <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>.</p>
<p>Let’s evaluate the function above halfway in between two grid points: <span class="math inline">\(x = x_1 + {1\over 2} (x_2 - x_1)\)</span> <span class="math display">\[\begin{align}
y(x_1 + {1\over 2} (x_2 - x_1)) &amp;= y_1 + { (y_2-y_1) \over (x_2-x_1) } (x_1 + {1\over 2} (x_2 - x_1)-x_1) \\
&amp;= y_1 + { (y_2-y_1) (x_2 - x_1) \over 2(x_2-x_1) } \\
&amp;= y_1 + {1\over 2} (y_2-y_1) \\
\end{align}\]</span></p>
<p>That’s a pretty cool result that we can generalize to</p>
<p><span id="eq-linear-interp"><span class="math display">\[
y(x_1 + ph) = y_1 + p (y_2-y_1)
\tag{15.2}\]</span></span></p>
<p>where p is a fraction of the grid spacing.</p>
</section>
<section id="linear-extrapolation" class="level3" data-number="15.1.2">
<h3 data-number="15.1.2" class="anchored" data-anchor-id="linear-extrapolation"><span class="header-section-number">15.1.2</span> Linear Extrapolation</h3>
<p>Now let’s evaluate the equation above beyond the last grid point at <span class="math inline">\(x_2 + h\)</span> where <span class="math inline">\(h = (x_2 - x_1)\)</span> is the grid spacing.</p>
<p><span id="eq-linear-extrapOne"><span class="math display">\[
\begin{align}
y(x_2 + (x_2 - x_1)) &amp;= y_1 + { (y_2-y_1) \over (x_2-x_1) } (x_2 + (x_2 - x_1)-x_1) \\
&amp;= y_1 + { (y_2-y_1) (2x_2 - 2x_1) \over (x_2-x_1) } \\
&amp;= y_1 + 2 (y_2-y_1) \\
&amp;= 2 y_2 - y_1
\end{align}
\tag{15.3}\]</span></span></p>
</section>
<section id="zero-finding" class="level3" data-number="15.1.3">
<h3 data-number="15.1.3" class="anchored" data-anchor-id="zero-finding"><span class="header-section-number">15.1.3</span> Zero Finding</h3>
<p>Sometimes you will want to find the x value that produces <span class="math inline">\(y(x) = 0\)</span>. We call that finding the zero of the function. We can do this by setting <span class="math inline">\(y =0\)</span> in (<a href="#eq-linear">Equation&nbsp;<span>15.1</span></a>) and solving for x:</p>
<p><span id="eq-zero-linear"><span class="math display">\[
\begin{align}
0 &amp;= y_1 + {y_2 - y_1 \over x_2 - x_1} (x - x_1)\\
-y_1 &amp; = {y_2 - y_1 \over x_2 - x_1} (x - x_1)\\
-{y_1 (x_2 - x_1)\over y_2 - y_1} &amp;= x - x_1\\
x_1 - {y_1 (x_2 - x_1)\over y_2 - y_1} &amp;= x \\
\end{align}
\tag{15.4}\]</span></span></p>
</section>
</section>
<section id="quadratic-interpolation-and-extrapolation" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="quadratic-interpolation-and-extrapolation"><span class="header-section-number">15.2</span> Quadratic Interpolation and Extrapolation</h2>
<p>A fancier technique for finding values between and beyond grid points is to use a parabola instead of a line. It takes three data points to define a parabola, so we need to start with the function values <span class="math inline">\((x_1,y_1)\)</span>, <span class="math inline">\((x_2,y_2)\)</span>, and <span class="math inline">\((x_3,y_3)\)</span>, as shown in the figure below.</p>
<div class="cell quarto-layout-panel" data-execution_count="4">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="extrapolation_interpolation_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img" width="416"></p>
<p></p><figcaption class="figure-caption">Illustration of quadratic interpolation/extrapolation. The red dots are the known function values. Black dots indicate interpolations and the green dot represents extrapolation.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>The general formula for a parabola is</p>
<p><span id="eq-quadratic"><span class="math display">\[
y=a + bx + cx^2
\tag{15.5}\]</span></span></p>
<p>where the coefficients <span class="math inline">\(a\)</span>, <span class="math inline">\(b,\)</span> and <span class="math inline">\(c\)</span> need to be chosen so that the parabola passes through our three data points. To determine these constants, you set up three equations that force the parabola to match the data points, like this: <span class="math display">\[\begin{align}
    y_1 &amp;= a + bx_1 + cx_1^2\\
    y_2 &amp;= a + bx_2 + cx_2^2\\
    y_3 &amp;= a + bx_3 + cx_3^2\\
\end{align}\]</span></p>
<p>We can solve this system of equations for <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span> and then plug these expressions back into (<a href="#eq-quadratic">Equation&nbsp;<span>15.5</span></a>) to get an approximation to the function in the neighborhood of these points. When we do this (it’s long and not super pretty so I’ll save you from the gory details) we find the following useful results for interpolating:</p>
<p><span id="eq-quadratic-interpOne"><span class="math display">\[
y(x_1 + {1\over 2} h) = {1\over 8} (3 y_1 + 6 y_2 - y_3)
\tag{15.6}\]</span></span></p>
<p><span id="eq-quadratic-interpTwo"><span class="math display">\[
y(x_2 + {1\over 2} h) = {1\over 8} (- y_1 + 6 y_2 + 3 y_3)
\tag{15.7}\]</span></span></p>
<p>and the following useful results for extrapolating</p>
<p><span id="eq-quadratic-extrapOne"><span class="math display">\[
y(x_3 +  h) =  y_1 - 3 y_2 + 3y_3
\tag{15.8}\]</span></span></p>
<p><span id="eq-quadratic-extrapTwo"><span class="math display">\[
y(x_3 +  {1\over 2}h) =  {1\over 8}(3 y_1 - 10 y_2 + 15y_3)
\tag{15.9}\]</span></span></p>
</section>
<section id="an-example" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="an-example"><span class="header-section-number">15.3</span> An Example</h2>
<p>Let’s take the example of the projectile that was mentioned at the beginning of this chapter (shown below again). The red dots are the known data points and let’s try to estimate the height of the projectile between the 3rd and 4th data points in the set (the blue dot) using both linear and quadratic methods.</p>
<div class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<p><img src="extrapolation_interpolation_files/figure-html/cell-5-output-1.png" width="579" height="404"></p>
</div>
</div>
<p>Let’s evaluate (<a href="#eq-linear-interp">Equation&nbsp;<span>15.2</span></a>) and (<a href="#eq-quadratic-interpOne">Equation&nbsp;<span>15.6</span></a>) to perform this interpolation in the cell below.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> linspace,sin,cos,pi</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>vi <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>θ <span class="op">=</span> <span class="dv">40</span> <span class="op">*</span> pi<span class="op">/</span><span class="dv">180</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> linspace(<span class="dv">0</span>,<span class="fl">3.5</span>,<span class="dv">10</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> vi <span class="op">*</span> cos(θ) <span class="op">*</span> t </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> vi <span class="op">*</span> sin(θ) <span class="op">*</span> t <span class="op">-</span> <span class="fl">4.9</span> <span class="op">*</span> t<span class="op">**</span><span class="dv">2</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>yInterpLinear <span class="op">=</span> y[<span class="dv">2</span>] <span class="op">+</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span> <span class="op">*</span> (y[<span class="dv">3</span>]<span class="op">-</span>y[<span class="dv">2</span>])</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>yInterpQuadratic <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span> <span class="op">*</span>(<span class="dv">3</span><span class="op">*</span>y[<span class="dv">2</span>] <span class="op">+</span> <span class="dv">6</span> <span class="op">*</span> y[<span class="dv">3</span>] <span class="op">-</span> y[<span class="dv">4</span>])</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(yInterpLinear)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(yInterpQuadratic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>13.931150961536407
14.11641330721542</code></pre>
</div>
</div>
<p>Notice that the linear and quadratic interpolations are close to the same number but they aren’t equal; we wouldn’t really expect them to be. Deciding which interpolation method is the best choice is a case-by-case decision. For this case, I would favor the quadratic interpolation since the trajectory is more parabolic than linear. Now let’s use the extrapolation formulas to estimate the projectile’s height past the last data point. For the linear case, the second-to-last data point is playing the role of <span class="math inline">\((x_1,y_1)\)</span> and the last data point is playing the role of <span class="math inline">\((x_2,y_2)\)</span>. For the quadratic case, the third-to-last data point is playing the role of <span class="math inline">\((x_1,y_1)\)</span>, the second-to-last data point is playing the role of <span class="math inline">\((x_2,y_2)\)</span>, and the last data point is playing the role of <span class="math inline">\((x_3,y_3)\)</span>. Best to use negative indices to index the data arrays for this case.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> linspace,sin,cos,pi</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>vi <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>θ <span class="op">=</span> <span class="dv">40</span> <span class="op">*</span> pi<span class="op">/</span><span class="dv">180</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> linspace(<span class="dv">0</span>,<span class="fl">3.5</span>,<span class="dv">10</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> vi <span class="op">*</span> cos(θ) <span class="op">*</span> t </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> vi <span class="op">*</span> sin(θ) <span class="op">*</span> t <span class="op">-</span> <span class="fl">4.9</span> <span class="op">*</span> t<span class="op">**</span><span class="dv">2</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>yExtrapLinear <span class="op">=</span> <span class="dv">2</span><span class="op">*</span> y[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> y[<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>yExtrapQuadratic <span class="op">=</span> y[<span class="op">-</span><span class="dv">3</span>] <span class="op">-</span> <span class="dv">3</span> <span class="op">*</span> y[<span class="op">-</span><span class="dv">2</span>] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> y[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(yExtrapLinear)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(yExtrapQuadratic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.3690482905900723
0.8869495251579806</code></pre>
</div>
</div>
<p>Now the quadratic and the linear extrapolations differ pretty significantly. The linear version is a better value in this case due to the very course grid being used here. Finally, let’s use (<a href="#eq-zero-linear">Equation&nbsp;<span>15.4</span></a>) to estimate the landing location for the projectile.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> linspace,sin,cos,pi</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>vi <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>θ <span class="op">=</span> <span class="dv">40</span> <span class="op">*</span> pi<span class="op">/</span><span class="dv">180</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> linspace(<span class="dv">0</span>,<span class="fl">3.5</span>,<span class="dv">10</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> vi <span class="op">*</span> cos(θ) <span class="op">*</span> t </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> vi <span class="op">*</span> sin(θ) <span class="op">*</span> t <span class="op">-</span> <span class="fl">4.9</span> <span class="op">*</span> t<span class="op">**</span><span class="dv">2</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>xRange <span class="op">=</span> x[<span class="op">-</span><span class="dv">2</span>] <span class="op">-</span> y[<span class="op">-</span><span class="dv">2</span>] <span class="op">*</span> (x[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> x[<span class="op">-</span><span class="dv">2</span>])<span class="op">/</span>(y[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> y[<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(xRange)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>93.52444507627928</code></pre>
</div>
</div>
</section>
<section id="flashcards" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="flashcards"><span class="header-section-number">15.4</span> Flashcards</h2>
<ol type="1">
<li>What is the difference between interpolation and extrapolation?</li>
<li>What is the equation for linear interpolation?</li>
<li>What is the equation for linear extrapolation?</li>
<li>What is the equation(s) for quadratic interpolation?</li>
<li>What is the equation(s) for quadratic extrapolation?</li>
<li>What is the equation for finding the zeros of a function?</li>
<li>Recite Moses 1:39.</li>
</ol>
</section>
<section id="exercises" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="exercises"><span class="header-section-number">15.5</span> Exercises</h2>
<!--1. This exercise is intended to give you practice interpolating, extrapolating, and finding zeros.  Follow the steps below:  
        
  1. Generate an array of $30$ equally-space x values from  $-12 < x < 12$.          
  2. Evaluate the function $y(x) = {\sin(x) \over x}$ on the grid.          
  3. Plot the data points (just the data points; don't connect them).        
  4. Use linear interpolation to estimate the value of the function between the 15th and 16th data point. (the points on either side of the peak.) Then compare to the true function value ($y(0)$) to see how close you got.          
  5. Use **quadratic** interpolation to estimate the value of the function between the 15th and 16th data point. Then compare to the true function value ($y(0)$) to see how close you got.          
  6. Use linear **extrapolation** to estimate the value of the function one grid point beyond the very last data point. Then compare to the true function value to see how close you got.  Reminder/Tip: If you use `linspace` to generate your grid, add `retstep = True` to return the step size along with the array.
  7. Use quadratic **extrapolation** to estimate the value of the function one grid point beyond the very last data point. Then compare to the true function value to see how close you got.          
  8. The function passes through zero between the 11th and 12th data point.  Use the linear zero-finding formula to determine the location of this zero.  Verify that it is close to the right answer by comparing with your plot.  

``` {.python .cell-code}
# Solution here
```


-->
<ol type="1">
<li>In the cell below, you will find the coordinates for a batted baseball flying through the air while experiencing non-negligible air drag.
<ol type="1">
<li>Plot the data.</li>
<li>Use the linear zero-finding formula (<a href="#eq-zero-linear">Equation&nbsp;<span>15.4</span></a>) to estimate the landing location of the ball.</li>
<li>Use linear interpolation to calculate the height of the projectile between the 2nd and 3rd data point. Make a visual inspection of the plot to ensure that your interpolation is reasonable.</li>
<li>Use <strong>quadratic</strong> interpolation to calculate the height of the projectile between the 2nd and 3rd data point. Make a visual inspection of the plot to ensure that your interpolation is reasonable.</li>
</ol></li>
</ol>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">0</span>, <span class="fl">15.805250773081712</span>, <span class="fl">29.98211261814125</span>, <span class="fl">42.526480802646844</span>, <span class="fl">53.54837374010167</span>, <span class="fl">63.375313562732956</span>, <span class="fl">72.28376367575353</span>, <span class="fl">80.43524080501983</span>, <span class="fl">87.9042108343639</span>, <span class="fl">94.71629032437068</span>, <span class="fl">100.88093230888737</span>, <span class="fl">106.41217684263896</span>] </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="dv">0</span>, <span class="fl">15.80525077308171</span>, <span class="fl">27.532112618141245</span>, <span class="fl">35.45860314481743</span>, <span class="fl">39.97307745470617</span>, <span class="fl">41.548109055524456</span>, <span class="fl">40.52592795902555</span>, <span class="fl">37.14060411207481</span>, <span class="fl">31.588726752728686</span>, <span class="fl">24.07513301195207</span>, <span class="fl">14.825650490213738</span>, <span class="fl">4.076523019892836</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li><a href="https://lancejnelson.github.io/PH135/files/carbondata.txt">This file</a> contains worldwide carbon emission data from 1958 to 2017.
<ol type="1">
<li>Read the data file using any method of your choosing.</li>
<li>Plot the data so you can see what it looks like.</li>
<li>Use linear extrapolation to predict what carbon emissions will be in the year 2030.<br>
</li>
<li>Use quadratic extrapolation to predict what carbon emissions will be in the year 2030.</li>
</ol>
Hints:
<ol type="1">
<li>Remember that our extrapolation formulas assume that the spacing between grid points is equal. Hence, to extrapolate to 2030, <span class="math inline">\(x_1\)</span> must correspond to 2004 <span class="math inline">\(x_2\)</span> should correspond to <span class="math inline">\(2017\)</span> for the linear extrapolation.</li>
<li>For the quadratic extrapolation, <span class="math inline">\(x_1\)</span> should correspond to 1991, <span class="math inline">\(x_2\)</span> to 2004 and <span class="math inline">\(x_3\)</span> to 2017. You could pick other years if you like as long as they are spaced out evenly.</li>
</ol></li>
</ol>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li><a href="https://lancejnelson.github.io/PH135/files/temperatureData.txt">This file</a> contains the change in average global temperature from 1958 to 2017.
<ol type="1">
<li>Read the data file using any method of your choosing.</li>
<li>Plot the data so you can see what it looks like.</li>
<li>Use linear extrapolation to predict what average global temperature change will be in the year 2030 if this trend continues.<br>
</li>
<li>Use quadratic extrapolation to predict what average global temperature change will be in the year 2030 if this trend continues.</li>
</ol></li>
</ol>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/sympy.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">The <code>sympy</code> module</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/fitting.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Curve Fitting</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>